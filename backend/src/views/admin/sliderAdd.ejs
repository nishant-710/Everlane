<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Add Slider</title>
</head>

<body style="margin: 0; font-family: Arial, sans-serif; background-color: #f4f6f8">
  <%- include('partials/sidebar') %>

    <div style="margin-left: 220px">
      <%- include('partials/header') %>

        <div style="padding: 30px">
          <h2 style="color: #2c3e50; text-align: center; margin-bottom: 30px">
            Add Slider
          </h2>

          <div style="
        max-width: 600px;
        margin: 0 auto;
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.08);
      ">
            <form action="/admin/sliderAdd" method="POST" enctype="multipart/form-data">
              <!-- Category Dropdown -->
              <label for="category" style="font-weight: bold">Category:</label>
              <select name="categoryId" required style="width: 100%; padding: 10px; margin-bottom: 20px">
                <option value="">-- Select Category --</option>
                <% if (category.length> 0) { category.forEach(cat => { %>
                  <option value="<%= cat._id %>">
                    <%= cat.name %>
                  </option>
                  <% }) } %>
              </select>

              <!-- Product Dropdown (will be shown dynamically) -->
              <div id="productContainer" style="display: none; margin-bottom: 20px;">
                <label for="productId" style="font-weight: bold">Product:</label>
                <select name="productId" id="productId" style="width: 100%; padding: 10px;">
                  <option value="">-- Select Product --</option>
                </select>
              </div>

              <!-- Mobile Image -->
              <div style="margin-bottom: 20px">
                <label style="display: block; margin-bottom: 8px; color: #2c3e50">Mobile Image</label>
                <input type="file" name="imageMobile" style="
              width: 100%;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 4px;
            " multiple />
              </div>

              <!-- Web Image -->
              <div style="margin-bottom: 20px">
                <label style="display: block; margin-bottom: 8px; color: #2c3e50">Web Image</label>
                <input type="file" name="imageWeb" style="
              width: 100%;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 4px;
            " multiple />
              </div>

              <!-- Title -->
              <div style="margin-bottom: 20px">
                <label style="display: block; margin-bottom: 8px; color: #2c3e50">Title</label>
                <input type="text" name="title" placeholder="Enter slider title" required style="
              width: 100%;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 4px;
            " />
              </div>

              <!-- Description -->
              <div style="margin-bottom: 20px">
                <label style="display: block; margin-bottom: 8px; color: #2c3e50">Description</label>
                <input type="text" name="description" placeholder="Enter slider description" required style="
              width: 100%;
              padding: 10px;
              border: 1px solid #ccc;
              border-radius: 4px;
            " />
              </div>

              <!-- Submit Button -->
              <div style="text-align: center">
                <button type="submit" style="
              padding: 10px 20px;
              background-color: #2980b9;
              color: white;
              border: none;
              border-radius: 4px;
              cursor: pointer;
            ">
                  Submit
                </button>
              </div>
            </form>
          </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $(document).ready(function () {
        $('select[name="categoryId"]').on('change', function () {
          const categoryId = $(this).val();

          if (!categoryId) {
            $('#productContainer').hide();
            $('#productId').html('<option value="">-- Select Product --</option>');
            return;
          }

          $.ajax({
            url: `/admin/getProducts/${categoryId}`,
            type: 'GET',
            success: function (data) {
              let options = '<option value="">-- Select Product --</option>';
              if (data.length > 0) {
                data.forEach(prod => {
                  options += `<option value="${prod._id}">${prod.name}</option>`;
                });
                $('#productId').html(options);
                $('#productContainer').show();
              } else {
                $('#productId').html(options);
                $('#productContainer').hide();
              }
            },
            error: function () {
              alert('Failed to load products');
            }
          });
        });
      });
    </script>
</body>

</html>